{
    "name": "GGP012_relazione_tra_output_port_services_type_e_specification",
    "displayName": "Relazione tra Output Port Services Type e Specification",
    "description": "Per tutte le output port specificate nel Data Product Descriptor, al momento della registrazione di una nuova versione di un Data Product, deve valere il seguente vincolo: se il tipo di servizio e' valorizzato come 'datastore-services', allora la specifica deve essere valorizzata come 'datastoreapi'; se il tipo di servizio e' valorizzato come 'rest-services', allora la specifica deve essere valorizzata come 'restapi'.",
    "blockingFlag": "true",
    "rawContent": "package GGP012_relazione_tra_output_port_services_type_e_specification\n\ndefault allow := false\n\nvalid_combination = {\"datastore-services\": \"datastoreapi\", \"rest-services\": \"restapi\"}\n\nallow { count({i | valid_combination[input.afterState.dataProductVersion.interfaceComponents.outputPorts[i].promises.servicesType] == input.afterState.dataProductVersion.interfaceComponents.outputPorts[i].promises.api.specification}) == count(input.afterState.dataProductVersion.interfaceComponents.outputPorts) }",
    "evaluationEvents": [
    {
      "event": "DATA_PRODUCT_VERSION_CREATION"
    }
  ],
    "filteringExpression": "true",
    "suite": "data_contract",
    "policyEngine":{
        "id": 1,
        "name": "opa_policy_engine"
    }
} 