{
    "name": "GGP010_valori_ammessi_per_output_port_services_type",
    "displayName": "Valori ammessi per Output Port Services Type",
    "description": "Il tipo di servizio di tutte le output port specificato nel Data Product Descriptor, al momento della registrazione di una nuova versione di un Data Product, deve essere uno e uno solo dei valori autorizzati: rest-services o datastore-services.",
    "blockingFlag": "true",
    "rawContent": "package GGP010_valori_ammessi_per_output_port_services_type\n\ndefault allow := false\n\nvalid_services_type := {\"datastore-services\", \"rest-services\"}\n\nallow { count({i | valid_services_type[input.afterState.dataProductVersion.interfaceComponents.outputPorts[i].promises.servicesType]}) == count(input.afterState.dataProductVersion.interfaceComponents.outputPorts)}",
    "evaluationEvents": [
    {
      "event": "DATA_PRODUCT_VERSION_CREATION"
    }
  ],
    "filteringExpression": "true",
    "suite": "data_contract",
    "policyEngine":{
        "id": 1,
        "name": "opa_policy_engine"
    }
} 